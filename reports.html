<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reports - LedgerBud</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <script src="js/theme.js"></script>
    <style>
        /* Dark Mode Styles - applied via html or body */
        html.dark-mode, html.dark-mode body,
        body.dark-mode {
            background-color: #111827 !important;
            color: #f9fafb !important;
        }
        html.dark-mode .bg-white, body.dark-mode .bg-white,
        .dark-mode .bg-white {
            background-color: #1f2937 !important;
        }
        html.dark-mode .bg-gray-50, body.dark-mode .bg-gray-50,
        .dark-mode .bg-gray-50 {
            background-color: #111827 !important;
        }
        html.dark-mode .bg-gray-100, body.dark-mode .bg-gray-100,
        .dark-mode .bg-gray-100 {
            background-color: #374151 !important;
        }
        html.dark-mode .border-gray-200, body.dark-mode .border-gray-200,
        .dark-mode .border-gray-200 {
            border-color: #374151 !important;
        }
        html.dark-mode .border-gray-300, body.dark-mode .border-gray-300,
        .dark-mode .border-gray-300 {
            border-color: #4b5563 !important;
        }
        html.dark-mode .text-gray-900, body.dark-mode .text-gray-900,
        .dark-mode .text-gray-900 {
            color: #f9fafb !important;
        }
        html.dark-mode .text-gray-700, body.dark-mode .text-gray-700,
        .dark-mode .text-gray-700 {
            color: #d1d5db !important;
        }
        html.dark-mode .text-gray-600, body.dark-mode .text-gray-600,
        .dark-mode .text-gray-600 {
            color: #9ca3af !important;
        }
        html.dark-mode .text-gray-500, body.dark-mode .text-gray-500,
        .dark-mode .text-gray-500 {
            color: #9ca3af !important;
        }
        html.dark-mode .hover\:bg-gray-100:hover, body.dark-mode .hover\:bg-gray-100:hover,
        .dark-mode .hover\:bg-gray-100:hover {
            background-color: #374151 !important;
        }
        html.dark-mode input, html.dark-mode select, html.dark-mode textarea,
        body.dark-mode input, body.dark-mode select, body.dark-mode textarea,
        .dark-mode input, .dark-mode select, .dark-mode textarea {
            background-color: #374151 !important;
            color: #f9fafb !important;
            border-color: #4b5563 !important;
        }
        html.dark-mode .divide-gray-200 > :not([hidden]) ~ :not([hidden]),
        body.dark-mode .divide-gray-200 > :not([hidden]) ~ :not([hidden]),
        .dark-mode .divide-gray-200 > :not([hidden]) ~ :not([hidden]) {
            border-color: #374151 !important;
        }

        /* High Contrast Mode Styles */
        html.high-contrast-mode, html.high-contrast-mode body,
        body.high-contrast-mode {
            background-color: #000000 !important;
            color: #ffffff !important;
        }
        html.high-contrast-mode .bg-white, body.high-contrast-mode .bg-white,
        .high-contrast-mode .bg-white {
            background-color: #000000 !important;
            border: 2px solid #ffffff !important;
        }
        html.high-contrast-mode .bg-gray-50, body.high-contrast-mode .bg-gray-50,
        .high-contrast-mode .bg-gray-50 {
            background-color: #000000 !important;
        }
        html.high-contrast-mode .bg-gray-100, body.high-contrast-mode .bg-gray-100,
        .high-contrast-mode .bg-gray-100 {
            background-color: #1a1a1a !important;
        }
        html.high-contrast-mode .border-gray-200, html.high-contrast-mode .border-gray-300,
        body.high-contrast-mode .border-gray-200, body.high-contrast-mode .border-gray-300,
        .high-contrast-mode .border-gray-200, .high-contrast-mode .border-gray-300 {
            border-color: #ffffff !important;
        }
        html.high-contrast-mode .text-gray-900, html.high-contrast-mode .text-gray-700,
        html.high-contrast-mode .text-gray-600, html.high-contrast-mode .text-gray-500,
        body.high-contrast-mode .text-gray-900, body.high-contrast-mode .text-gray-700,
        body.high-contrast-mode .text-gray-600, body.high-contrast-mode .text-gray-500,
        .high-contrast-mode .text-gray-900, .high-contrast-mode .text-gray-700,
        .high-contrast-mode .text-gray-600, .high-contrast-mode .text-gray-500 {
            color: #ffffff !important;
        }
        html.high-contrast-mode .text-green-600, body.high-contrast-mode .text-green-600,
        .high-contrast-mode .text-green-600 {
            color: #00ff00 !important;
        }
        html.high-contrast-mode .text-red-600, body.high-contrast-mode .text-red-600,
        .high-contrast-mode .text-red-600 {
            color: #ff0000 !important;
        }
        html.high-contrast-mode .text-blue-600, body.high-contrast-mode .text-blue-600,
        .high-contrast-mode .text-blue-600 {
            color: #00ffff !important;
        }
        html.high-contrast-mode .bg-blue-600, body.high-contrast-mode .bg-blue-600,
        .high-contrast-mode .bg-blue-600 {
            background-color: #0000ff !important;
            border: 2px solid #ffffff !important;
        }
        html.high-contrast-mode .hover\:bg-gray-100:hover, body.high-contrast-mode .hover\:bg-gray-100:hover,
        .high-contrast-mode .hover\:bg-gray-100:hover {
            background-color: #333333 !important;
        }
        html.high-contrast-mode input, html.high-contrast-mode select, html.high-contrast-mode textarea,
        body.high-contrast-mode input, body.high-contrast-mode select, body.high-contrast-mode textarea,
        .high-contrast-mode input, .high-contrast-mode select, .high-contrast-mode textarea {
            background-color: #000000 !important;
            color: #ffffff !important;
            border: 2px solid #ffffff !important;
        }
        html.high-contrast-mode a, html.high-contrast-mode button,
        body.high-contrast-mode a, body.high-contrast-mode button,
        .high-contrast-mode a, .high-contrast-mode button {
            text-decoration: underline;
        }
        html.high-contrast-mode .divide-gray-200 > :not([hidden]) ~ :not([hidden]),
        body.high-contrast-mode .divide-gray-200 > :not([hidden]) ~ :not([hidden]),
        .high-contrast-mode .divide-gray-200 > :not([hidden]) ~ :not([hidden]) {
            border-color: #ffffff !important;
        }

        /* Theme option styles */
        .theme-option {
            transition: all 0.2s ease;
        }
        .theme-option:hover {
            transform: scale(1.05);
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="flex h-screen overflow-hidden">
        <!-- Sidebar -->
        <aside class="w-64 bg-white border-r border-gray-200">
            <div class="h-full flex flex-col">
                <!-- Logo -->
                <div class="p-6 border-b border-gray-200">
                    <h1 class="text-2xl font-semibold text-gray-900">LedgerBud</h1>
                </div>

                <!-- Navigation -->
                <nav class="flex-1 p-4">
                    <ul class="space-y-2">
                        <li>
                            <a href="dashboard.html" class="flex items-center px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 rounded-md">
                                <span>Dashboard</span>
                            </a>
                        </li>
                        <li>
                            <a href="add.html" class="flex items-center px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 rounded-md">
                                <span>Add Transaction</span>
                            </a>
                        </li>
                        <li>
                            <a href="history.html" class="flex items-center px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 rounded-md">
                                <span>History</span>
                            </a>
                        </li>
                        <li>
                            <a href="reports.html" class="flex items-center px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md">
                                <span>Reports</span>
                            </a>
                        </li>
                    </ul>
                </nav>

                <!-- User Profile Dropdown -->
                <div class="p-4 border-t border-gray-200 relative">
                    <button id="profileBtn" onclick="toggleProfileDropdown()" class="flex items-center w-full px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 rounded-md">
                        <div class="w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center mr-3 overflow-hidden">
                            <img id="profileBtnImg" src="" alt="Profile" class="w-full h-full object-cover hidden">
                            <svg id="profileBtnPlaceholder" class="w-5 h-5 text-gray-500" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                        <span id="profileBtnName">My Profile</span>
                        <svg class="w-4 h-4 ml-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                        </svg>
                    </button>
                    <!-- Dropdown Menu -->
                    <div id="profileDropdown" class="hidden absolute bottom-full left-4 right-4 mb-2 bg-white border border-gray-200 rounded-lg shadow-lg overflow-hidden z-50">
                        <button onclick="showProfileModal(); toggleProfileDropdown();" class="flex items-center w-full px-4 py-3 text-sm font-medium text-gray-700 hover:bg-gray-100">
                            <svg class="w-4 h-4 mr-3 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                            </svg>
                            <span>My Profile</span>
                        </button>
                        <div class="border-t border-gray-200"></div>
                        <button id="logoutBtn" onclick="showLogoutConfirmation(); toggleProfileDropdown();" class="flex items-center w-full px-4 py-3 text-sm font-medium text-red-600 hover:bg-red-50">
                            <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
                            </svg>
                            <span>Logout</span>
                        </button>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <div class="flex-1 flex flex-col overflow-hidden">
            <!-- Top Navbar -->
            <header class="bg-white border-b border-gray-200">
                <div class="px-6 py-4 flex items-center justify-between">
                    <h2 class="text-xl font-semibold text-gray-900">Reports</h2>
                    <div class="flex items-center">
                        <span class="text-sm text-gray-600">Welcome, <span id="userName" class="font-medium text-gray-900"></span></span>
                    </div>
                </div>
            </header>

            <!-- Main Content Area -->
            <main class="flex-1 overflow-y-auto p-6">
                <!-- Monthly Trend Chart -->
                <div class="bg-white border border-gray-200 rounded-lg p-6 shadow-sm mb-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Monthly Trends</h3>
                    <div id="monthlyTrendChart"></div>
                </div>

                <!-- Category Analysis -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                    <!-- Income by Category -->
                    <div class="bg-white border border-gray-200 rounded-lg p-6 shadow-sm">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">Income by Category</h3>
                        <div id="incomeCategoryChart"></div>
                    </div>

                    <!-- Expense by Category -->
                    <div class="bg-white border border-gray-200 rounded-lg p-6 shadow-sm">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">Expense by Category</h3>
                        <div id="expenseCategoryChart"></div>
                    </div>
                </div>

                <!-- Savings Growth -->
                <div class="bg-white border border-gray-200 rounded-lg p-6 shadow-sm mb-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Savings Growth</h3>
                    <div id="savingsGrowthChart"></div>
                </div>

                <!-- Summary Statistics -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <!-- Average Monthly Income -->
                    <div class="bg-white border border-gray-200 rounded-lg p-6 shadow-sm">
                        <h4 class="text-sm font-medium text-gray-600 mb-2">Average Monthly Income</h4>
                        <p class="text-2xl font-semibold text-green-600" id="avgIncome">$0.00</p>
                    </div>

                    <!-- Average Monthly Expense -->
                    <div class="bg-white border border-gray-200 rounded-lg p-6 shadow-sm">
                        <h4 class="text-sm font-medium text-gray-600 mb-2">Average Monthly Expense</h4>
                        <p class="text-2xl font-semibold text-red-600" id="avgExpense">$0.00</p>
                    </div>

                    <!-- Savings Rate -->
                    <div class="bg-white border border-gray-200 rounded-lg p-6 shadow-sm">
                        <h4 class="text-sm font-medium text-gray-600 mb-2">Savings Rate</h4>
                        <p class="text-2xl font-semibold text-blue-600" id="savingsRate">0%</p>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script src="js/auth.js"></script>
    <script src="js/transactions.js"></script>
    <script src="js/reports.js"></script>

    <!-- Logout Confirmation Modal -->
    <div id="logoutModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-md w-full mx-4 p-6">
            <h3 class="text-lg font-semibold text-gray-900 mb-4">Confirm Logout</h3>
            <p class="text-gray-600 mb-6">Are you sure you want to logout?</p>
            <div class="flex justify-end space-x-3">
                <button onclick="hideLogoutConfirmation()" class="px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md">Cancel</button>
                <button onclick="logout()" class="px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-md">Logout</button>
            </div>
        </div>
    </div>

    <!-- Profile Modal -->
    <div id="profileModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-lg w-full mx-4 max-h-[90vh] overflow-y-auto">
            <div class="p-6 border-b border-gray-200">
                <div class="flex justify-between items-center">
                    <h3 class="text-lg font-semibold text-gray-900">My Profile</h3>
                    <button onclick="hideProfileModal()" class="text-gray-400 hover:text-gray-600">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
            </div>
            <div class="p-6 space-y-6">
                <!-- Profile Picture -->
                <div class="flex flex-col items-center">
                    <div class="w-24 h-24 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden mb-3">
                        <img id="profilePicturePreview" src="" alt="Profile" class="w-full h-full object-cover hidden">
                        <svg id="profilePicturePlaceholder" class="w-12 h-12 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"></path>
                        </svg>
                    </div>
                    <label class="cursor-pointer text-blue-600 hover:text-blue-700 text-sm font-medium">
                        Change Photo
                        <input type="file" id="profilePictureInput" accept="image/*" class="hidden" onchange="handleProfilePictureUpload(event)">
                    </label>
                </div>

                <!-- Profile Info -->
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Name</label>
                        <input type="text" id="profileName" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                        <input type="email" id="profileEmail" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <button onclick="saveProfile()" class="w-full px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md">Save Profile</button>
                </div>

                <!-- Change Password -->
                <div class="border-t border-gray-200 pt-6">
                    <h4 class="text-md font-semibold text-gray-900 mb-4">Change Password</h4>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Current Password</label>
                            <input type="password" id="currentPassword" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">New Password</label>
                            <input type="password" id="newPassword" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Confirm New Password</label>
                            <input type="password" id="confirmNewPassword" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        <button onclick="handleChangePassword()" class="w-full px-4 py-2 text-sm font-medium text-white bg-gray-600 hover:bg-gray-700 rounded-md">Change Password</button>
                    </div>
                </div>

                <!-- Theme Settings -->
                <div class="border-t border-gray-200 pt-6">
                    <h4 class="text-md font-semibold text-gray-900 mb-4">Theme</h4>
                    <div class="grid grid-cols-4 gap-3">
                        <button onclick="setTheme('light')" data-theme="light" class="theme-option flex flex-col items-center p-3 border border-gray-200 rounded-lg hover:bg-gray-50">
                            <div class="w-10 h-10 rounded-full bg-gray-100 border-2 border-gray-300 flex items-center justify-center mb-2">
                                <svg class="w-5 h-5 text-yellow-500" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd"></path>
                                </svg>
                            </div>
                            <span class="text-xs font-medium text-gray-700">Light</span>
                        </button>
                        <button onclick="setTheme('dark')" data-theme="dark" class="theme-option flex flex-col items-center p-3 border border-gray-200 rounded-lg hover:bg-gray-50">
                            <div class="w-10 h-10 rounded-full bg-gray-800 border-2 border-gray-600 flex items-center justify-center mb-2">
                                <svg class="w-5 h-5 text-yellow-300" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path>
                                </svg>
                            </div>
                            <span class="text-xs font-medium text-gray-700">Dark</span>
                        </button>
                        <button onclick="setTheme('system')" data-theme="system" class="theme-option flex flex-col items-center p-3 border border-gray-200 rounded-lg hover:bg-gray-50">
                            <div class="w-10 h-10 rounded-full bg-gradient-to-r from-gray-100 to-gray-800 border-2 border-gray-400 flex items-center justify-center mb-2">
                                <svg class="w-5 h-5 text-gray-600" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M3 5a2 2 0 012-2h10a2 2 0 012 2v8a2 2 0 01-2 2h-2.22l.123.489.804.804A1 1 0 0113 18H7a1 1 0 01-.707-1.707l.804-.804L7.22 15H5a2 2 0 01-2-2V5zm5.771 7H5V5h10v7H8.771z" clip-rule="evenodd"></path>
                                </svg>
                            </div>
                            <span class="text-xs font-medium text-gray-700">System</span>
                        </button>
                        <button onclick="setTheme('high-contrast')" data-theme="high-contrast" class="theme-option flex flex-col items-center p-3 border border-gray-200 rounded-lg hover:bg-gray-50">
                            <div class="w-10 h-10 rounded-full bg-black border-2 border-white flex items-center justify-center mb-2" style="box-shadow: 0 0 0 2px black;">
                                <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M10 12a2 2 0 100-4 2 2 0 000 4z"></path>
                                    <path fill-rule="evenodd" d="M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z" clip-rule="evenodd"></path>
                                </svg>
                            </div>
                            <span class="text-xs font-medium text-gray-700">Contrast</span>
                        </button>
                    </div>
                </div>

                <!-- Danger Zone -->
                <div class="border-t border-gray-200 pt-6">
                    <h4 class="text-md font-semibold text-red-600 mb-4">Danger Zone</h4>
                    <div class="space-y-3">
                        <button onclick="handleDeleteAllTransactions()" class="w-full px-4 py-2 text-sm font-medium text-red-600 bg-red-50 hover:bg-red-100 border border-red-200 rounded-md">Delete All Transactions & History</button>
                        <button onclick="handleRemoveAccount()" class="w-full px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-md">Remove Account Permanently</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Check authentication
        checkAuth();

        // Display username
        const userName = localStorage.getItem('userName');
        if (userName) {
            document.getElementById('userName').textContent = userName;
        }

        // Update profile button image on load
        updateProfileButtonImage();


        // Save profile handler
        function saveProfile() {
            const name = document.getElementById('profileName').value;
            const email = document.getElementById('profileEmail').value;
            
            if (name && email) {
                updateUserProfile({ name, email });
                document.getElementById('userName').textContent = name;
                alert('Profile updated successfully!');
            } else {
                alert('Please fill in all fields');
            }
        }

        // Change password handler
        function handleChangePassword() {
            const currentPassword = document.getElementById('currentPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmNewPassword = document.getElementById('confirmNewPassword').value;
            
            if (!currentPassword || !newPassword || !confirmNewPassword) {
                alert('Please fill in all password fields');
                return;
            }
            
            if (newPassword !== confirmNewPassword) {
                alert('New passwords do not match');
                return;
            }
            
            if (newPassword.length < 6) {
                alert('Password must be at least 6 characters long');
                return;
            }
            
            const result = changePassword(currentPassword, newPassword);
            alert(result.message);
            
            if (result.success) {
                document.getElementById('currentPassword').value = '';
                document.getElementById('newPassword').value = '';
                document.getElementById('confirmNewPassword').value = '';
            }
        }

        // Delete all transactions handler
        function handleDeleteAllTransactions() {
            if (confirm('Are you sure you want to delete ALL transactions and history? This action cannot be undone!')) {
                if (confirm('This will permanently remove all your financial data. Continue?')) {
                    const result = deleteAllTransactionsAndHistory();
                    alert(result.message);
                    location.reload();
                }
            }
        }

        // Remove account handler
        function handleRemoveAccount() {
            if (confirm('Are you sure you want to permanently delete your account? This action cannot be undone!')) {
                if (confirm('All your data including transactions will be lost forever. Continue?')) {
                    removeAccountPermanently();
                }
            }
        }

        // Load reports
        document.addEventListener('DOMContentLoaded', function() {
            loadReports();
        });
    </script>
</body>
</html>
